---
layout : post
permalink : /content/installing-apc-on-leopard/index.html
author : "Matt Dunn"
author_id : 11
title : "Installing APC on Leopard"
date : "2009-02-03 12:02:17"
dateformatted : "February 3 2009, 12:02"
excerpt : |
    <p>Some short notes on getting APC to work nicely with OS X Leopard.</p>
categories : 
   - February 2009
   - "Matt Dunn"
comments : |
    <li class="odd" id="comment-5450">
    <div class="comment-text"><p>A similar approach for mcrypt:
    <a href=\"http://michaelgracie.com/2008/12/26/plugging-mcrypt-into-php-on-leopard-10.5.6/\">Plugging mcrypt into PHP, on Leopard 10.5.6</a></p></div>
    <p class="comment-info">by 
    <a href="http://www.contentwithstyle.co.uk" rel="nofollow"></a>on February 9 2009, 15:24<a href="#comment-5450">#</a>
    </p>
    </li>
    <li class="even" id="comment-5451">
    <div class="comment-text"><p>
    And here is something for <a href=\"http://gidden.net/tom/2008/06/30/mysql-and-pdo-on-os-x-leopard-intel/\">MySQL and PDO on OS X Leopard, Intel</a>
    </p>
    
    <p>Also <a href=\"http://www.viames.it/mac-os-x.html\">this guy</a> has a couple of pre-compiled binaries</p></div>
    <p class="comment-info">by 
    <a href="http://www.contentwithstyle.co.uk" rel="nofollow"></a>on February 9 2009, 15:46<a href="#comment-5451">#</a>
    </p>
    </li>
    <li class="odd" id="comment-5556">
    <div class="comment-text">Thanks.  I was having a bit of trouble getting this going on my Leopard server (no problems on a PPC box running Tiger Server).  Your command line for configure did something that worked and I now have it going.
    
    Here\'s a follow on question.   I\'ve expanded the shared memory segment to 128Mb.  Is that not necessary any longer...with Tiger and surely earlier, the default shared memory segment was 4Mb.    </div>
    <p class="comment-info">by 
    <a href="http://timesync.gmu.edu/wordpress" rel="nofollow"></a>on February 26 2009, 14:54<a href="#comment-5556">#</a>
    </p>
    </li>
    <li class="even" id="comment-5422">
    <div class="comment-text"><p>
    Just to give the man a bit more of an introduction: Matt was my team leader for quite some time, and I have learned tremendous amounts from working with him. I am very very happy that I could persuade him to do the occasional post here, even more so as this is he is the first contributor for CwS apart from Matthias, Mike and me so far. A milestone, so to say.
    </p>
    
    <p>
    Good to have you here, Matt!
    </p></div>
    <p class="comment-info">by 
    <a href="http://www.contentwithstyle.co.uk" rel="nofollow"></a>on February 3 2009, 12:07<a href="#comment-5422">#</a>
    </p>
    </li>
    <li class="odd" id="comment-7495">
    <div class="comment-text"><p>Matt,</p>
    
    <p>Thank you for this info, I got down to the second to last command before I had any problems.</p>
    <p>
    When I run \'make\' I get the following errors:</p>
    
    <pre><code>/usr/local/php5/bin/APC-3.0.19/php_apc.c:959: error: duplicate \'static\'
    /usr/local/php5/bin/APC-3.0.19/php_apc.c:959: error: duplicate \'static\'
    /usr/local/php5/bin/APC-3.0.19/php_apc.c:959: error: duplicate \'static\'
    /usr/local/php5/bin/APC-3.0.19/php_apc.c:959: error: duplicate \'static\'
    lipo: can\'t open input file: /var/folders/WL/WLuS6cKnE0mu8N+eRzVeDk+++TM/-Tmp-//ccPNdzLH.out (No such file or directory)
    make: *** [php_apc.lo] Error 1</code></pre>
    
    <p>
    Any help would be great!!</p>
    
    <p>
    Thanks,
    Michael</p></div>
    <p class="comment-info">by 
    on November 10 2009, 17:06<a href="#comment-7495">#</a>
    </p>
    </li>
    <li class="even" id="comment-8479">
    <div class="comment-text">To compile it, comment out line 959, or 958; the line just contains <code>static</code>.</div>
    <p class="comment-info">by 
    on June 30 2010, 17:43<a href="#comment-8479">#</a>
    </p>
    </li>
    <li class="odd" id="comment-8218">
    <div class="comment-text">Michael, I\'m having the same issue. Did you ever get it resolved?
    
    If others have any idea what may be causing our \"php_apc.c:959: error: duplicate \'static\'\" build error, please let us know.</div>
    <p class="comment-info">by 
    on March 15 2010, 23:20<a href="#comment-8218">#</a>
    </p>
    </li>
    <li class="even" id="comment-9807">
    <div class="comment-text">We have a very busy website.  We\'ve found the MacPorts APC extension (php5-apc) is a lot easier to setup and install with the MacPorts PHP build, which makes using the latest version of PHP really easy.  The downside with MacPorts PHP, though, is that you have to use the MacPorts Apache instead of the Apple Apache because the latter crashes when attempting to load the MacPorts PHP module.
    
    We noticed a 50% improvement in CPU utilization with MacPorts.  I\'m sure a custom build could improve on that maybe another 5%, but 50% is good enough given the other benefits MacPorts offers.</div>
    <p class="comment-info">by 
    on January 20 2011, 18:24<a href="#comment-9807">#</a>
    </p>
    </li>
    <li class="odd" id="comment-9847">
    <div class="comment-text">So Lando, do you use this in a production environment or just as a dev box?</div>
    <p class="comment-info">by 
    <a href="http://www.contentwithstyle.co.uk" rel="nofollow"></a>on January 22 2011, 09:27<a href="#comment-9847">#</a>
    </p>
    </li>
    
---

<p>There are a few steps needed to install <a href="http://www.php.net/apc">APC</a> on OS X Leopard. Don't worry, it may look a bit daunting if you've never had to compile anything before but it's very straight forward.</p>

<ul>
<li>First, download the appropriate version of the <a href="http://pecl.php.net/package/APC">APC package</a></li>
<li>Unpack it (doesn't matter where)</li>
<li>Now start Terminal and cd to the unpacked directory from the above step</li>
<li>Run 'phpize'</li>
<li>Now it needs to be configured. Copy the following configuration (note: it must be entered into the Terminal prompt as a <strong>single</strong> line)</li>
</ul>

<pre><code>MACOSX_DEPLOYMENT_TARGET=10.5 CFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe -no-cpp-precomp" CCFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" CXXFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" LDFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -bind_at_load" ./configure</code></pre>

<ul>
<li>Nearly there: now type 'make'</li>
<li>sudo make install (you will need to enter your root password)</li>
<li>Finally, add 'extension=apc.so' into your php.ini</li>
</ul>

<p>And that's it!</p>

